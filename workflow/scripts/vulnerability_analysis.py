import json


def vulnerability_analysis(input_file, output_file):
    # Read the input JSON file
    with open(input_file, 'r', encoding='UTF-8') as file:
        network_logs = json.load(file)

    vulnerability_report = {
        "risk_level": "Low",
        "vulnerable_devices": 0,
        "total_devices": len(network_logs),
        "device_reports": []
    }

    high_risk = 0

    for device in network_logs:
        device_report = {
            "ip_address": device["ip_address"],
            "OS": device["operating_system"],
            "vulnerabilities": device["potential_vulnerabilities"],
            "risk_level": "Low"
        }

        if len(device["potential_vulnerabilities"]) > 2:
            device_report["risk_level"] = "High"
            high_risk += 1
        elif len(device["potential_vulnerabilities"]) > 0:
            device_report["risk_level"] = "Medium"

        if device["potential_vulnerabilities"]:
            vulnerability_report["vulnerable_devices"] += 1

        vulnerability_report["device_reports"].append(device_report)

    if high_risk > 2:
        vulnerability_report["risk_level"] = "High"
    elif high_risk > 0:
        vulnerability_report["risk_level"] = "Medium"

    # Write the vulnerability report to the output file
    with open(output_file, 'w', encoding='UTF-8') as file:
        json.dump(vulnerability_report, file, indent=4)
